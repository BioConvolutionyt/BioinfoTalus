<!-- markdownlint-disable MD041 -->

### BioinfoTalus

BioinfoTalus 是一个面向生物信息学转录组数据分析的 R 脚本集合，覆盖 **Bulk 转录组**、**单细胞转录组** 与 **空间转录组**三大领域，包含常见算法与分析流程的可复用实现与示例数据。

### 🎯项目特点

- **既可作为一套完整 pipeline，也可独立使用**：脚本之间通过中间产物（如 `.Rda`、`.txt`、`.csv`）衔接；同时每个脚本也尽量设计为“拿来即用”的独立模块。
- **可泛化 + 注释较完整**：核心步骤与关键参数已尽量写成可迁移的形式，并对需要按数据调整的部分进行了注释；尤其是**数据读取/预处理**相关位置可能需要根据实际数据结构做少量修改。
- **提供示例数据与部分运行结果**：提供了示例数据，以及部分脚本运行后生成的结果文件，请先按“数据文件下载”从 GitHub Releases 获取并放置到 `Data/`，即可快速上手与复现。

### 📚目录结构

- **`Bulk 转录组测序数据分析/`**：TCGA/GEO 数据处理、差异分析、富集分析、GSEA、免疫浸润/评分、生存与回归建模、WGCNA、药物敏感性等；
- **`单细胞转录组测序数据分析/`**：Seurat 主流程（读入/QC/聚类/去批次）、细胞注释、双细胞/细胞周期、CNV 推断、拟时序、发育潜能、细胞通讯等；
- **`空间转录组测序数据分析/`**：Visium 读入与聚类、空间反卷积（基于单细胞先验）、空间差异基因、空间细胞通讯等；
- **`Data/`**：示例数据、参考资源与部分脚本运行结果的存放文件夹，中间文件与输出文件默认也会写回此目录，为避免仓库体积过大，Git 仓库中 `Data/` 默认为空，数据文件具体内容存放在 GitHub Releases（见数据文件下载）；

### 💡示例数据说明

- **Bulk 转录组**：示例使用 **TCGA-HNSC** 数据集（下载数据后，按脚本要求放置于 `Data/TCGA/` 相关目录）；
- **单细胞转录组（10x）**：示例来自 **GSM9113377、GSM9113378、GSM9113379**，为**结直肠癌**样本（下载数据后位于 `Data/10x Single Cell/`）；
- **空间转录组（10x Visium）**：示例来自 **GSM8594561**，同为**结直肠癌**样本（下载数据后位于 `Data/10x Visium/`）；
  - 注意：空间示例与单细胞示例**不配对**（可用于演示流程与方法，但不代表严格的配对设计）；

### 🧩数据文件下载

项目提供的示例数据、参考资源与部分运行结果文件较大，请从 GitHub Releases 下载 ([datafiles](https://github.com/BioConvolutionyt/BioinfoTalus/releases/tag/datafiles))：

1. 下载所有 `data_split*.zip` 文件；
2. 解压；
3. 将解压后的文件（从data_split*文件夹中取出来）统一放在根目录的 **`Data/`** 文件夹下；

### 📍运行方式

建议使用 RStudio 打开 `BioinfoTalus.Rproj`，并将工作目录设置为项目根目录（脚本普遍使用 `Data/...` 相对路径读写）。

#### 作为 pipeline（推荐顺序）

你可以按下面顺序从“原始/半成品数据”一路跑到下游分析；也可以只跑其中某一段。

- **Bulk（TCGA 与 GEO 示例）**
  - `Bulk 转录组测序数据分析/TCGA表达数据处理.R`（生成表达矩阵 `.Rda`）
  - `Bulk 转录组测序数据分析/差异分析.R`（DESeq2 差异分析）
  - `Bulk 转录组测序数据分析/GO & KEGG富集分析.R` 与/或 `Bulk 转录组测序数据分析/GSEA.R`
  - `Bulk 转录组测序数据分析/免疫、肿瘤、基质评分计算.R`（ESTIMATE）
  - `Bulk 转录组测序数据分析/生存分析.R`、`单因素COX回归.R`、`多因素COX回归.R`、`LASSO.R`、`Nomogram.R`
  - 其他：`Cibersort_main.R`（免疫浸润）、`WGCNA.R`、`药物敏感性分析.R`、`免疫检查点分析.R`、`TCGA体细胞突变数据整理.R`、`GEO芯片数据处理.R` 等按需选用

- **单细胞（10x 示例，Seurat）**
  - `单细胞转录组测序数据分析/单细胞测序数据读取与质控.R`
  - `单细胞转录组测序数据分析/单细胞测序数据降维、聚类、去除批次效应.R`
  - `单细胞转录组测序数据分析/细胞注释.R`
  - 其他模块：`双细胞去除.R`、`细胞周期去除.R`、`inferCNV.R`、`CopyKat.R`、`拟时序分析（monocle2）.R`、`拟时序分析（monocle3）.R`、`Slingshot.R`、`CytoTRACE2.R`、`细胞通讯.R`、`AUCell.R`、`hdWGCNA.R` 、`Pesudo-Bulk`等

- **空间转录组（Visium 示例，Seurat Spatial）**
  - `空间转录组测序数据分析/空间转录组数据处理.R`
  - `空间转录组测序数据分析/反卷积.R`（需要单细胞对象的细胞类型先验）
  - `空间转录组测序数据分析/空间差异基因分析.R`（SPARK）
  - `空间转录组测序数据分析/空间细胞通讯分析.R`

#### 独立运行某个脚本

大多数脚本在开头会 `load(...)` 或 `read...(...)` 指定其所需输入。若你希望将其用于自己的数据：

- 按脚本注释准备输入文件/对象（路径、列名、分组信息、注释信息等）；
- 根据需求调整少量参数（例如 QC 阈值、`pcs`、`resolution`、基因集路径、分组 cutpoint 等）；
- 运行后输出一般会写入 `Data/`（或当前目录下的 pdf/csv），便于与下游脚本衔接；

#### 报错处理

如果代码报错，请检查文件路径与依赖包版本是否正常。

### 🏷️依赖与环境提示

脚本在运行时会通过 `library(...)` 加载所需包；如缺失请按报错信息安装。项目覆盖面较广，涉及 CRAN、Bioconductor 以及少量第三方包（如 CellChat/infercnv 等），建议在一个相对干净的 R 环境中逐步安装与验证。

#### 关键依赖版本

- **R / Bioconductor**
  - `base`: 4.5.0
  - `BiocVersion`: 3.21.1（`BiocManager`: 1.30.26）
- **Bulk**
  - `DESeq2`: 1.48.1
  - `clusterProfiler`: 4.16.0（`org.Hs.eg.db`: 3.21.0；`pathview`: 1.48.0）
  - `estimate`: 1.0.13
  - `GSVA`: 2.2.0
  - `limma`: 3.64.1
  - `oncoPredict`: 1.2
- **单细胞 / 空间**
  - `Seurat`: 5.4.0
  - `SeuratObject`: 5.3.0
  - `igraph`: 2.0.1
  - `harmony`: 1.2.3
  - `CellChat`: 1.6.1
  - `infercnv`: 1.24.0
  - `monocle`: 2.36.0；`monocle3`: 1.4.26
  - `DoubletFinder`: 2.0.6；`copykat`: 1.1.0
  - `CytoTRACE2`: 1.1.0；`AUCell`: 1.30.1；`hdWGCNA`: 0.4.06
  - `clustree`: 0.5.1；`patchwork`: 1.3.1

编码方面，脚本文件名与注释包含中文，建议使用 **UTF-8** 打开与保存。

### 🖌️贡献与致谢

作者水平有限，脚本实现与参数选择难免存在不足。欢迎你在学习与使用过程中：

- 提交 Issue 反馈问题与改进建议；
- 分享你自己的实现思路/代码片段；
- 通过 PR 添加补丁（例如：更通用的数据读取、更多数据类型支持、更完善的异常处理与可视化等）；

如有任何问题、建议或补丁想法，欢迎随时邮件联系我：

- **Email**：`YtLiu-53846@outlook.com`

此外，如果你觉得这个项目对你有所帮助，欢迎点个⭐️支持一下，也欢迎在引用或分享时注明来源。后续可能还会不定期更新一些新的算法，衷心感谢大家的支持🙏！














